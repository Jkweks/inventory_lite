(function(){const t=document.getElementById('themeSwitch');function s(e){document.documentElement.setAttribute('data-bs-theme',e),localStorage.setItem('theme',e)}const a=localStorage.getItem('theme')||'dark';s(a),t&&(t.checked=a==='light',t.addEventListener('change',()=>s(t.checked?'light':'dark')));window.exportTableToPDF=function(e,n){const{ jsPDF:o }=window.jspdf,d=new o({orientation:'landscape',unit:'pt',format:'letter'}),l=document.getElementById(e);if(!l)return alert('Table not found');let r=40;d.setFontSize(14),d.text(n||'Inventory Report',40,r),r+=20;const i=[],c=[];l.querySelectorAll('thead th').forEach(h=>c.push(h.innerText.trim())),l.querySelectorAll('tbody tr').forEach(h=>{const m=[];h.querySelectorAll('td').forEach(u=>m.push(u.innerText.trim())),i.push(m)});const f=150;let p=40;c.forEach((h,m)=>{d.text(h,p+m*f,r)}),r+=14,i.forEach(h=>{h.forEach((m,u)=>d.text(String(m),p+u*f,r)),r+=14,r>540&&(d.addPage(),r=40)}),d.save((n||'report')+'.pdf')}})();